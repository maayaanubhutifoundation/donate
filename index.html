<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Donate to Maaya Anubhuti Foundation</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <style>
    body {
      background-color: #fff9e6;
      padding: 40px 10px;
    }
    .container {
      max-width: 720px;
      margin: auto;
      background: #fff;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 0 12px rgba(0,0,0,0.1);
    }
    h1, h3 {
      color: #e68a00;
      text-align: center;
      margin-bottom: 10px;
    }
    p.description {
      text-align: center;
      color: #5e4300;
      font-size: 16px;
      margin-bottom: 15px;
    }
    p.note {
      text-align: center;
      color: #a94442;
      font-weight: bold;
      margin-bottom: 20px;
    }
    .form-control {
      width: 100%;
    }
    .mobile-wrapper {
      position: relative;
    }
    .mobile-wrapper input {
      padding-left: 50px;
    }
    .mobile-wrapper::before {
      content: "+91";
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      font-weight: bold;
      color: #555;
    }
    .form-check-label {
      font-size: 14px;
    }
    .read-more {
      display: none;
    }
    .read-toggle {
      color: #007BFF;
      border: none;
      background: none;
      cursor: pointer;
      font-size: 14px;
      margin-left: 5px;
    }
    .btn-primary {
      background-color: #ff9900;
      border: none;
    }
    .btn-primary:hover {
      background-color: #e68a00;
    }
    #otpSection {
      margin-top: 20px;
    }
    #authConfirmed, #postAuthContent {
      display: none;
      margin-top: 30px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Support Maaya Anubhuti Foundation ðŸ’›</h1>
    <p class="description">Empowering elderly care and youth training. Join this noble journey with your kind support.</p>
    <p class="note">Please verify your mobile number before proceeding to donation.</p>

    <form id="donationForm">
      <div class="mb-3">
        <label for="name" class="form-label">Full Name*</label>
        <input type="text" class="form-control" id="name" required>
      </div>

      <div class="mb-3">
        <label for="mobile" class="form-label">Mobile Number*</label>
        <div class="mobile-wrapper">
          <input type="tel" class="form-control" id="mobile" pattern="[0-9]{10}" required placeholder="xxxxxxxxxx">
        </div>
      </div>

      <div class="mb-3">
        <label for="email" class="form-label">Email (Optional)</label>
        <input type="email" class="form-control" id="email">
      </div>

      <div class="mb-3">
        <label for="amount" class="form-label">Amount Donated* (Min â‚¹50)</label>
        <input type="number" class="form-control" id="amount" min="50" required>
      </div>

      <div class="mb-3">
        <label for="message" class="form-label">Message (Optional)</label>
        <textarea class="form-control" id="message" rows="2"></textarea>
      </div>

      <div class="form-check mb-2">
        <input class="form-check-input" type="checkbox" id="declaration" required>
        <label class="form-check-label" for="declaration">
          I hereby declare I am an Indian citizen donating my own funds.
        </label>
      </div>

      <div class="form-check mb-3">
        <input class="form-check-input" type="checkbox" id="anonymous">
        <label class="form-check-label" for="anonymous">I opt to keep my name anonymous.</label>
      </div>

      <div id="otpSection" class="d-none">
        <label for="otp">Enter OTP:</label>
        <input type="text" id="otp" class="form-control mt-1 mb-2">
        <div id="otpFeedback" class="fw-bold mt-1"></div>
      </div>

      <div class="cf-turnstile mb-3" data-sitekey="0x4AAAAAABnuBDDS5ho0ShrZ"></div>
      <button type="button" class="btn btn-primary w-100" id="submitBtn">Submit</button>
    </form>

    <div id="authConfirmed" class="alert alert-success">âœ… Mobile number authenticated. You may now proceed with your donation.</div>

    <div id="postAuthContent">
      <h3>Make Your Donation</h3>
      <p>Your generous donation to Maaya Anubhuti helps us provide compassionate care for the elderly, build safe and comfortable old age homes, and empower underprivileged youth with training to become skilled caregivers. Every contribution, big or small, makes a meaningful impact. Please choose a donation method below:</p>
      <h5>UPI Payment Options:</h5>
      <p><strong>UPI ID:</strong> 9599914274@idbi</p>
      <p><strong>Scan QR Code:</strong></p>
      <img src="https://assets.zyrosite.com/cdn-cgi/image/format=auto,w=768,h=896,fit=crop/A0xj3j1bO7C10DBz/qr_code-m6Lb0BlRRqs7MEGd.png" alt="UPI QR" class="img-fluid mb-3"/>

      <h5>Bank Transfer:</h5>
      <p><strong>Account Name:</strong> Maaya Anubhuti Foundation<br>
      <strong>Account Number:</strong> 0873102000012698<br>
      <strong>IFSC Code:</strong> IBKL0000873<br>
      <strong>Bank:</strong> IDBI Bank Ltd.<br>
      <strong>Branch:</strong> Indirapuram, Ghaziabad, UP</p>
    </div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAG6BcfLCiBG4nX2dqa0YDCqtbgiET4qQg",
      authDomain: "maaya-donation-project.firebaseapp.com",
      projectId: "maaya-donation-project",
      storageBucket: "maaya-donation-project.appspot.com",
      messagingSenderId: "893542409484",
      appId: "1:893542409484:web:6ce0ff5bc7e51de69f1529"
    };
    firebase.initializeApp(firebaseConfig);

    let confirmationResult;
    const otpSection = document.getElementById("otpSection");
    const authConfirmed = document.getElementById("authConfirmed");
    const postAuthContent = document.getElementById("postAuthContent");
    const submitBtn = document.getElementById("submitBtn");

    let otpMode = false;

    submitBtn.addEventListener("click", () => {
      const phone = "+91" + document.getElementById("mobile").value;
      const otp = document.getElementById("otp").value;

      if (!otpMode) {
        const amount = parseInt(document.getElementById("amount").value);
        if (!document.getElementById("declaration").checked) return alert("Please accept the declaration.");
        if (!/\+91[6-9]\d{9}/.test(phone)) return alert("Invalid phone.");
        if (isNaN(amount) || amount < 50) return alert("Min â‚¹50 required.");

        window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('submitBtn', { size: 'invisible' });
        window.recaptchaVerifier.verify().then(() => {
          return firebase.auth().signInWithPhoneNumber(phone, window.recaptchaVerifier);
        }).then(result => {
          confirmationResult = result;
          otpSection.classList.remove("d-none");
          submitBtn.textContent = "Submit OTP";
          otpMode = true;
        }).catch(err => {
          alert("Error sending OTP: " + err.message);
        });
      } else {
        confirmationResult.confirm(otp).then(() => {
          authConfirmed.style.display = "block";
          document.getElementById("donationForm").style.display = "none";
          postAuthContent.style.display = "block";
        }).catch(err => {
          document.getElementById("otpFeedback").textContent = "Wrong OTP";
          document.getElementById("otpFeedback").style.color = "red";
        });
      }
    });
  </script>
</body>
</html>
